<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Lịch trình Tour Hạ Long</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #fafafa;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
        }

        .day-section {
            margin-bottom: 40px;
        }

        .day-title {
            font-size: 1.5em;
            margin-bottom: 10px;
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
        }

        .event {
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-left-width: 4px;
            border-radius: 8px;
            margin: 12px 0;
            background: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .event:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transform: translateY(-1px);
        }

        .event.past {
            border-left-color: #6c757d;
            background: #f8f9fa;
            opacity: 0.7;
        }

        .event.current {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #e9f7ef 0%, #d4edda 100%);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.2);
        }

        .event.upcoming {
            border-left-color: #007bff;
            background: linear-gradient(135deg, #e7f1ff 0%, #d1ecf1 100%);
        }

        .event-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .time {
            font-weight: 600;
            font-size: 14px;
            color: #495057;
            background: rgba(0,0,0,0.05);
            padding: 4px 8px;
            border-radius: 4px;
            min-width: 120px;
            text-align: center;
        }

        .copy-btn {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,123,255,0.3);
        }

        .copy-btn:hover {
            background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,123,255,0.4);
        }

        .copy-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,123,255,0.3);
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            box-shadow: 0 2px 4px rgba(40,167,69,0.3);
        }

        .content {
            font-size: 14px;
            line-height: 1.6;
            color: #212529;
            white-space: pre-wrap;
            margin-bottom: 8px;
        }

        .note {
            font-style: italic;
            color: #6c757d;
            font-size: 13px;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 3px solid #17a2b8;
            margin-top: 8px;
        }
    </style>
</head>

<body>

    <h1>Lịch trình Tour Hạ Long</h1>
    <div id="schedule"></div>

    <script>
        const data = [
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "7:45-8:00",
                "Nội dung": "Tập trung Xe và hdv đón tại điểm hẹn",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "08:00-11:30",
                "Nội dung": "Khởi hành đến bến tàu Tuần Châu",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "11:30-12:00",
                "Nội dung": "check in tại nhà chờ La Regina Cruises – Lô 24 Bến Tuần Châu",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "12:15-12:30",
                "Nội dung": "- Di chuyển bằng tender hoặc xuồng cao tốc để ra du thuyền ngoài vịnh Lan Hạ - một vùng biển thật thanh bình.\n- Nghe hướng dẫn nội dung an toàn trên tàu trước khi nhận phòng",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "13:00-14:00",
                "Nội dung": "Ăn trưa",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "15:30:00",
                "Nội dung": "Du thuyền đến khu vực Hang Sáng Tối.\nCó thể hoạt động chèo kayak",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "17:30:00",
                "Nội dung": "Trở lại tàu ngắm hoàng hôn, thưởng thức chương trình \"happy hour\"",
                "note": null
            },
            {
                "Đề mục": "Ngày 1",
                "Thời gian": "19:00:00",
                "Nội dung": "Ăn tối",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "06:00:00",
                "Nội dung": "Cùng ngắm bình minh trong không khí trong lành và khung cảnh thơ mộng của Vịnh Lan Hạ. Tham gia lớp học thái cực quyền để bắt đầu một ngày mới thật nhiều năng lượng.",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "06:45:00",
                "Nội dung": "Bữa sáng nhẹ tại nhà hàng",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "07:30:00",
                "Nội dung": "Thăm quan hang Trung Trang trên đảo Cát Bà",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "09:30:00",
                "Nội dung": "Trở lại tàu nghỉ ngơi, check out phòng",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "09:45:00",
                "Nội dung": "Bữa trưa buffet được phục vụ tại nhà hàng trong khi du thuyền quay trở lại bến tàu",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "11:00:00",
                "Nội dung": "Trở về bến, kết thúc chương trình trên du thuyền",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "11:15:00",
                "Nội dung": "Di chuyển xuống Quang Hanh - đến suối nước nóng Yoko onsen",
                "note": "Ghé qua khách sạn cho những ai không đi tắm onsen"
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "18:30:00",
                "Nội dung": "Ăn buffet chuẩn Nhật tại nhà hàng",
                "note": null
            },
            {
                "Đề mục": "Ngày 2",
                "Thời gian": "20:00:00",
                "Nội dung": "Quay trở lại khách sạn",
                "note": null
            },
            {
                "Đề mục": "Ngày 3",
                "Thời gian": "07:00-08:00",
                "Nội dung": "Ăn sáng tại khách sạn",
                "note": null
            },
            {
                "Đề mục": "Ngày 3",
                "Thời gian": "8h30-12:00",
                "Nội dung": "Tham gia các trải nghiệm tại công viên nước, công viên rồng....",
                "note": "Báo HDV lấy hộ nhé (chi phí tự túc)"
            },
            {
                "Đề mục": "Ngày 3",
                "Thời gian": "12:30-13:30",
                "Nội dung": "Ăn trưa",
                "note": null
            },
            {
                "Đề mục": "Ngày 3",
                "Thời gian": "18:00:00",
                "Nội dung": "Gala Dinner",
                "note": null
            },
            {
                "Đề mục": "Ngày 3",
                "Thời gian": "19:30:00",
                "Nội dung": "Hoạt động tự do",
                "note": null
            },
            {
                "Đề mục": "Ngày 4",
                "Thời gian": "07:00-08:00",
                "Nội dung": "Ăn sáng tại khách sạn",
                "note": null
            },
            {
                "Đề mục": "Ngày 4",
                "Thời gian": "9:30:00",
                "Nội dung": "Checkout, mua sắm quà... (có xe đón tại khách sạn)",
                "note": "bạn nào không đi mua sắm có thể chờ ở khách sạn để dùng bữa trưa cùng đoàn"
            },
            {
                "Đề mục": "Ngày 4",
                "Thời gian": "11:00:00",
                "Nội dung": "Checkout khách sạn",
                "note": null
            },
            {
                "Đề mục": "Ngày 4",
                "Thời gian": "11:30-12:00",
                "Nội dung": "Ăn trưa",
                "note": null
            },
            {
                "Đề mục": "Ngày 4",
                "Thời gian": null,
                "Nội dung": "Về HN",
                "note": null
            }
        ];

        // Ngày bắt đầu: 11/07/2025
        const baseDate = new Date("2025-07-11T00:00:00");
        const now = new Date();

        // format "15h30" hoặc "15h"
        function formatTime(d) {
            const h = d.getHours(), m = d.getMinutes();
            return m ? `${h}h${m.toString().padStart(2, '0')}` : `${h}h`;
        }

        // parse mỗi mục
        function parseEvent(item) {
            const dayMatch = item['Đề mục'].match(/Ngày\s*(\d+)/);
            const offset = dayMatch ? parseInt(dayMatch[1], 10) - 1 : 0;
            const date = new Date(baseDate);
            date.setDate(date.getDate() + offset);

            let start = new Date(date), end = new Date(date);
            const t = item['Thời gian'];
            let timeStr;
            if (t && /\d/.test(t)) {
                const parts = t.split(/[-–]/).map(s => s.trim());
                const toDT = s => {
                    const [h, m] = s.split(':');
                    const d = new Date(date);
                    d.setHours(+h, +m, 0);
                    return d;
                };
                start = toDT(parts[0]);
                end = parts[1] ? toDT(parts[1]) : new Date(start.getTime() + 3600000);
                timeStr = parts[1]
                    ? `${formatTime(start)} - ${formatTime(end)}`
                    : formatTime(start);
            } else {
                timeStr = 'Chưa rõ';
                start.setHours(0, 0, 0);
                end.setHours(23, 59, 59);
            }

            return { ...item, date, start, end, timeStr };
        }

        // nhóm giữ thứ tự
        const eventsByDate = {}, dayOrder = [];
        data.forEach(item => {
            const evt = parseEvent(item);
            const dayKey = evt.date.toLocaleDateString('vi-VN', { weekday: 'long', day: 'numeric', month: 'numeric', year: 'numeric' });
            if (!eventsByDate[dayKey]) { eventsByDate[dayKey] = []; dayOrder.push(dayKey) }
            eventsByDate[dayKey].push(evt);
        });

        // render
        const container = document.getElementById('schedule');
        dayOrder.forEach(dayKey => {
            const section = document.createElement('div'); section.className = 'day-section';
            const title = document.createElement('div'); title.className = 'day-title'; title.textContent = dayKey;
            section.appendChild(title);

            eventsByDate[dayKey].forEach(evt => {
                const state = now > evt.end ? 'past' : now >= evt.start ? 'current' : 'upcoming';
                const div = document.createElement('div');
                div.className = `event ${state}`;

                // Tạo header chứa thời gian và nút copy
                const header = document.createElement('div');
                header.className = 'event-header';

                // time
                const timeSpan = document.createElement('div');
                timeSpan.className = 'time';
                timeSpan.textContent = evt.timeStr;
                header.appendChild(timeSpan);

                // nút copy
                const copyBtn = document.createElement('button');
                copyBtn.className = 'copy-btn';
                copyBtn.textContent = 'Copy';
                copyBtn.onclick = () => {
                    let copyText = `${evt.timeStr} - ${evt['Nội dung']}`;
                    if (evt.note) {
                        copyText += `\nGhi chú: ${evt.note}`;
                    }

                    navigator.clipboard.writeText(copyText).then(() => {
                        copyBtn.textContent = 'Đã copy!';
                        copyBtn.classList.add('copied');
                        setTimeout(() => {
                            copyBtn.textContent = 'Copy';
                            copyBtn.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Không thể copy: ', err);
                        // Fallback cho trình duyệt cũ
                        const textArea = document.createElement('textarea');
                        textArea.value = copyText;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);

                        copyBtn.textContent = 'Đã copy!';
                        copyBtn.classList.add('copied');
                        setTimeout(() => {
                            copyBtn.textContent = 'Copy';
                            copyBtn.classList.remove('copied');
                        }, 2000);
                    });
                };
                header.appendChild(copyBtn);

                                div.appendChild(header);

                // nội dung
                const content = document.createElement('div'); 
                content.className = 'content';
                content.textContent = evt['Nội dung'] || ''; 
                div.appendChild(content);

                // note nếu có
                if (evt.note) {
                    const noteDiv = document.createElement('div');
                    noteDiv.className = 'note';
                    noteDiv.textContent = `Ghi chú: ${evt.note}`;
                    div.appendChild(noteDiv);
                }

                section.appendChild(div);
            });

            container.appendChild(section);
        });
    </script>

</body>

</html>